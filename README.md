# SmediaBH
person TelegramAPP for purchase funnel



### Требования:
1. python 3.10.12,
2. docker version 24.0.6, build ed223bc,
3. make 4.3

### Задание:
Использовать sqlalchemy (asyncpg) - для БД,
pyrogram - для взаимодействия с Telegram API.
Логировать каждую успешную отправку сообщения с помощью loguru.
Сделать возможность просмотра кол-во зарегистрированный людей
в БД за сегодня с помощью отправки команды /users_today в избранное аккаунта.

### Описание:
Написал небольшое приложение по макету из тестового задания
используя: SQLalchemy, pydantic, asyncpg, Pyrogram, Loguru.

Приложение отвечает на сообщения новых пользователей (которых нет в БД) и демонстрирует
материалы для пользователей, с которыми они могут ознакомиться (в дальнейшем приобрести).

Логи успешно отправленных сообщений хранятся в корне приложения logs/info.log

Для запуска проект необходимо будет создать API_ID и API_HASH и записать
их в файл в корне проекта .env
Ссылка по созданию [API_ID](https://core.telegram.org/api/obtaining_api_id):  

При отправке команнды `/users_today` в избранные сообщения бот выдаст
информацию о новых регистрация за сегодня

Бот не будет отвечать на свои же сообщения, заисключением коммандных. 

Бот будет всегда проверять каждое сообщение от любого пользователя из личного чата
на хранение его данных в БД, если пользователя не было в БД, он будет создан и 
запустится скрипт с предложением материалов.

В контейнер не прокинул volumes, т.к. это лишь макет,
поэтому информация записанная в БД уничтожается по прекращения работы контейнера

#### Локальный запуск:
1. Активировать виртуальное окружение
2. `pip install -r requirements.txt` - Установка библиотек
3. в файл .env дописать в поля API_ID и API_HASH ваши уникальные значения.
4. `make up_local` - Команда поднимет бд, прогонит миграции и запустит приложение
5. Дальше запустится скрипт от pyrogram который попросит вас авторизовать вашу учетную запись.
6. После авторизации приложение готово к работе.
7. ctrl+C для завершения работы приложения и `make down_local` для прекращения работы контейнера
